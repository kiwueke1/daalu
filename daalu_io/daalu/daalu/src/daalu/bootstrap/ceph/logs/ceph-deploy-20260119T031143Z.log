# Ceph deployment log started 20260119T031143Z UTC


[2026-01-19T03:11:43Z] (unknown) $ sudo -S bash -lc 'command -v docker || command -v podman'
(unknown) [stdout]
/usr/bin/docker

(unknown) [exit 0]

[2026-01-19T03:11:43Z] (unknown) $ bash -lc 'command -v cephadm || echo MISSING'
(unknown) [stdout]
/usr/local/bin/cephadm

(unknown) [exit 0]
[2026-01-19T03:11:43Z] [ceph] Fixing cephadm on auto-openstack-infra-22jdj

[2026-01-19T03:11:44Z] (auto-openstack-infra-22jdj) $ sudo -S bash -lc '
    set -euo pipefail

    patch_file() {
    f="$1"
    [ -f "$f" ] || return 0

    if ! grep -q "item, mode = line.split" "$f"; then
        echo "ERROR: expected AppArmor line not found in $f" >&2
        exit 1
    fi

    cp "$f" "$f.bak"

    python3 - <<EOF
    from pathlib import Path
    p = Path("$f")
    txt = p.read_text()
    txt = txt.replace(
        "item, mode = line.split('\'' '\'')",
        "item, mode = line.split(None, 1)"
    ).replace(
        '\''item, mode = line.split(" ")'\'',
        "item, mode = line.split(None, 1)"
    )
    p.write_text(txt)
    EOF

    python3 -m py_compile "$f"
    }

    # System cephadm binaries
    patch_file /usr/local/bin/cephadm
    patch_file /usr/sbin/cephadm

    # Runtime cephadm copies
    for f in /var/lib/ceph/*/cephadm.*; do
    patch_file "$f"
    done
    '
(auto-openstack-infra-22jdj) [stderr]
bash: line 40: warning: here-document at line 15 delimited by end-of-file (wanted `EOF')
bash: -c: line 41: syntax error: unexpected end of file

(auto-openstack-infra-22jdj) [exit 2]
[2026-01-19T03:11:44Z] [ceph] Fixing cephadm on auto-openstack-infra-nfqd6

[2026-01-19T03:11:44Z] (auto-openstack-infra-nfqd6) $ sudo -S bash -lc '
    set -euo pipefail

    patch_file() {
    f="$1"
    [ -f "$f" ] || return 0

    if ! grep -q "item, mode = line.split" "$f"; then
        echo "ERROR: expected AppArmor line not found in $f" >&2
        exit 1
    fi

    cp "$f" "$f.bak"

    python3 - <<EOF
    from pathlib import Path
    p = Path("$f")
    txt = p.read_text()
    txt = txt.replace(
        "item, mode = line.split('\'' '\'')",
        "item, mode = line.split(None, 1)"
    ).replace(
        '\''item, mode = line.split(" ")'\'',
        "item, mode = line.split(None, 1)"
    )
    p.write_text(txt)
    EOF

    python3 -m py_compile "$f"
    }

    # System cephadm binaries
    patch_file /usr/local/bin/cephadm
    patch_file /usr/sbin/cephadm

    # Runtime cephadm copies
    for f in /var/lib/ceph/*/cephadm.*; do
    patch_file "$f"
    done
    '
(auto-openstack-infra-nfqd6) [stderr]
bash: line 40: warning: here-document at line 15 delimited by end-of-file (wanted `EOF')
bash: -c: line 41: syntax error: unexpected end of file

(auto-openstack-infra-nfqd6) [exit 2]
[2026-01-19T03:11:45Z] [ceph] Fixing cephadm on auto-openstack-infra-p8wn4

[2026-01-19T03:11:45Z] (auto-openstack-infra-p8wn4) $ sudo -S bash -lc '
    set -euo pipefail

    patch_file() {
    f="$1"
    [ -f "$f" ] || return 0

    if ! grep -q "item, mode = line.split" "$f"; then
        echo "ERROR: expected AppArmor line not found in $f" >&2
        exit 1
    fi

    cp "$f" "$f.bak"

    python3 - <<EOF
    from pathlib import Path
    p = Path("$f")
    txt = p.read_text()
    txt = txt.replace(
        "item, mode = line.split('\'' '\'')",
        "item, mode = line.split(None, 1)"
    ).replace(
        '\''item, mode = line.split(" ")'\'',
        "item, mode = line.split(None, 1)"
    )
    p.write_text(txt)
    EOF

    python3 -m py_compile "$f"
    }

    # System cephadm binaries
    patch_file /usr/local/bin/cephadm
    patch_file /usr/sbin/cephadm

    # Runtime cephadm copies
    for f in /var/lib/ceph/*/cephadm.*; do
    patch_file "$f"
    done
    '
(auto-openstack-infra-p8wn4) [stderr]
bash: line 40: warning: here-document at line 15 delimited by end-of-file (wanted `EOF')
bash: -c: line 41: syntax error: unexpected end of file

(auto-openstack-infra-p8wn4) [exit 2]
[2026-01-19T03:11:47Z] [ceph] Fixing cephadm on auto-openstack-infra-sxcfp-47b85

[2026-01-19T03:11:47Z] (auto-openstack-infra-sxcfp-47b85) $ sudo -S bash -lc '
    set -euo pipefail

    patch_file() {
    f="$1"
    [ -f "$f" ] || return 0

    if ! grep -q "item, mode = line.split" "$f"; then
        echo "ERROR: expected AppArmor line not found in $f" >&2
        exit 1
    fi

    cp "$f" "$f.bak"

    python3 - <<EOF
    from pathlib import Path
    p = Path("$f")
    txt = p.read_text()
    txt = txt.replace(
        "item, mode = line.split('\'' '\'')",
        "item, mode = line.split(None, 1)"
    ).replace(
        '\''item, mode = line.split(" ")'\'',
        "item, mode = line.split(None, 1)"
    )
    p.write_text(txt)
    EOF

    python3 -m py_compile "$f"
    }

    # System cephadm binaries
    patch_file /usr/local/bin/cephadm
    patch_file /usr/sbin/cephadm

    # Runtime cephadm copies
    for f in /var/lib/ceph/*/cephadm.*; do
    patch_file "$f"
    done
    '
(auto-openstack-infra-sxcfp-47b85) [stderr]
bash: line 40: warning: here-document at line 15 delimited by end-of-file (wanted `EOF')
bash: -c: line 41: syntax error: unexpected end of file

(auto-openstack-infra-sxcfp-47b85) [exit 2]
[2026-01-19T03:11:48Z] [ceph] Fixing cephadm on auto-openstack-infra-sxcfp-52nsw

[2026-01-19T03:11:48Z] (auto-openstack-infra-sxcfp-52nsw) $ sudo -S bash -lc '
    set -euo pipefail

    patch_file() {
    f="$1"
    [ -f "$f" ] || return 0

    if ! grep -q "item, mode = line.split" "$f"; then
        echo "ERROR: expected AppArmor line not found in $f" >&2
        exit 1
    fi

    cp "$f" "$f.bak"

    python3 - <<EOF
    from pathlib import Path
    p = Path("$f")
    txt = p.read_text()
    txt = txt.replace(
        "item, mode = line.split('\'' '\'')",
        "item, mode = line.split(None, 1)"
    ).replace(
        '\''item, mode = line.split(" ")'\'',
        "item, mode = line.split(None, 1)"
    )
    p.write_text(txt)
    EOF

    python3 -m py_compile "$f"
    }

    # System cephadm binaries
    patch_file /usr/local/bin/cephadm
    patch_file /usr/sbin/cephadm

    # Runtime cephadm copies
    for f in /var/lib/ceph/*/cephadm.*; do
    patch_file "$f"
    done
    '
(auto-openstack-infra-sxcfp-52nsw) [stderr]
bash: line 40: warning: here-document at line 15 delimited by end-of-file (wanted `EOF')
bash: -c: line 41: syntax error: unexpected end of file

(auto-openstack-infra-sxcfp-52nsw) [exit 2]
[2026-01-19T03:11:50Z] [ceph] Fixing cephadm on auto-openstack-infra-sxcfp-xlvpz

[2026-01-19T03:11:50Z] (auto-openstack-infra-sxcfp-xlvpz) $ sudo -S bash -lc '
    set -euo pipefail

    patch_file() {
    f="$1"
    [ -f "$f" ] || return 0

    if ! grep -q "item, mode = line.split" "$f"; then
        echo "ERROR: expected AppArmor line not found in $f" >&2
        exit 1
    fi

    cp "$f" "$f.bak"

    python3 - <<EOF
    from pathlib import Path
    p = Path("$f")
    txt = p.read_text()
    txt = txt.replace(
        "item, mode = line.split('\'' '\'')",
        "item, mode = line.split(None, 1)"
    ).replace(
        '\''item, mode = line.split(" ")'\'',
        "item, mode = line.split(None, 1)"
    )
    p.write_text(txt)
    EOF

    python3 -m py_compile "$f"
    }

    # System cephadm binaries
    patch_file /usr/local/bin/cephadm
    patch_file /usr/sbin/cephadm

    # Runtime cephadm copies
    for f in /var/lib/ceph/*/cephadm.*; do
    patch_file "$f"
    done
    '
(auto-openstack-infra-sxcfp-xlvpz) [stderr]
bash: line 40: warning: here-document at line 15 delimited by end-of-file (wanted `EOF')
bash: -c: line 41: syntax error: unexpected end of file

(auto-openstack-infra-sxcfp-xlvpz) [exit 2]

[2026-01-19T03:11:51Z] (unknown) $ sudo -S bash -lc '(podman pull quay.io/ceph/ceph:v20.2.0 || docker pull quay.io/ceph/ceph:v20.2.0) || true'
(unknown) [stderr] bash: line 1: podman: command not found
(unknown) [stdout]
v20.2.0: Pulling from ceph/ceph
Digest: sha256:1228c3d05e45fbc068a8c33614e4409b6dac688bcc77369b06009b5830fa8d86
Status: Image is up to date for quay.io/ceph/ceph:v20.2.0
quay.io/ceph/ceph:v20.2.0

(unknown) [exit 0]

[2026-01-19T03:11:52Z] (unknown) $ bash -lc 'sudo cephadm shell -- ceph status >/dev/null 2>&1 || test -f /etc/ceph/ceph.conf'
(unknown) [exit 1]

[2026-01-19T03:11:54Z] (unknown) $ sudo -S bash -lc 'cephadm --image quay.io/ceph/ceph:v20.2.0 bootstrap --mon-ip 192.168.111.20 --initial-dashboard-user admin --initial-dashboard-password admin --skip-monitoring-stack --allow-overwrite'
(unknown) [stdout] Verifying podman|docker is present...
Verifying lvm2 is present...
Verifying time synchronization is in place...
(unknown) [stdout] Unit systemd-timesyncd.service is enabled and running
Repeating the final host check...
docker (/usr/bin/docker) is present
systemctl is present
lvcreate is present
Unit systemd-timesyncd.service is enabled and running
Host looks OK
Cluster fsid: 9b71dbf3-f4e4-11f0-96e3-007b3f868e0e
Verifying IP 192.168.111.20 port 3300 ...
Verifying IP 192.168.111.20 port 6789 ...
Mon IP `192.168.111.20` is in CIDR network `192.168.111.0/24`
Mon IP `192.168.111.20` is in CIDR network `192.168.111.0/24`
Internal network (--cluster-network) has not been provided, OSD replication will default to the public_network
Pulling container image quay.io/ceph/ceph:v20.2.0...
(unknown) [stdout]
Ceph version: ceph version 20.2.0 (69f84cc2651aa259a15bc192ddaabd3baba07489) tentacle (stable)

(unknown) [stderr]
ERROR: Container release tentacle != cephadm release quincy; please use matching version of cephadm (pass --allow-mismatched-release to continue anyway)

(unknown) [exit 1]
